<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>WAVE</title>
    <link rel="stylesheet" href="src/index.css">
</head>

<body>
    <!--sidebar nav-->
    <div class="sidebar" id="sidebar">
        <a class="activeNav" id="instrumentLink" href="#instruments" onclick="loadTab('instrumentLink', 'instrumentTab')">Instruments</a>
        <a href="#patterns" id="patternLink" onclick="loadTab('patternLink', 'patternTab')">Patterns</a>
        <a href="#sequencer" id="sequencerLink" onclick="loadTab('sequencerLink', 'sequenceTab')">Sequencer</a>
        <a href="#file" id="fileLink" onclick="loadTab('fileLink', 'fileTab')">File</a>
    </div>

    <!--main app-->
    <div class="content" id="content">
        <div class="activeNav" id="instrumentTab">
            <!--instruments-->
            <ul id="instrumentList"></ul>
            <div id="instrumentButtons">
                <button onclick="addInstrument()">Add Instrument</button>
                <button onclick="removeInstrument()">Remove Instrument</button>
            </div>
            <div hidden id="instrumentSettings">
                Instrument: <input id="instName" type="text" name="instName" oninput="changeInstName(this.value)" />
                <br /> Waveform: <select name="instType" id="waveformSelector" onchange="changeWaveform(this.value)">
                    <option value="pulse" class="active" selected>Pulse</option>
                    <option value="sawtooth">Sawtooth</option>
                    <option value="triangle">Triangle</option>
                    <option value="pwm">PWM</option>
                    <option value="noise">Noise</option>
                </select>
                <br />
                <div hidden id="pulseWidth">
                    Pulse Width: <input type="range" id="pWidthSlider" class="slider" name="width" min="0" max="1" step="0.01"
                        oninput="changePulseWidth(this.value)">
                    <div id="pWidthText"></div>
                </div>
                <div hidden id="modFreq">
                    Modulation Frequency: <input type="range" id="modFreqSlider" class="slider" name="width" min="0" max="1"
                        step="0.01" oninput="changeModulationFrequency(this.value)">
                    <div id="modFreqText"></div>
                </div>
            </div>
            <p id="bigspace"></p>
            <div id='keyboard'></div>
        </div>
        <div hidden id="patternTab">
            <!--patterns-->
            <p>patterns</p>
        </div>
        <div hidden id="sequenceTab">
            <!--sequencer-->
            <p>sequencer</p>
        </div>
        <div hidden id="fileTab">
            <!--file i/o-->
            <p>file</p>
        </div>
    </div>

    <script src="src/index.js"></script>
    <script src="src/instruments.js"></script>
    <script src="src/qwerty-hancock.js"></script>
    <script>
        var keyboard = new QwertyHancock({
            id: 'keyboard',
            width: 600,
            height: 150,
            octaves: 2,
            startNote: 'A3',
            whiteNotesColour: 'white',
            blackNotesColour: 'black',
            hoverColour: '#000080'
        });

        keyboard.keyDown = function (note, frequency) {
            let instCh = instrumentList.getElementsByClassName('active');
            if (instCh[0] !== null) {
                let activeInst = instruments[nodeIndex(instCh[0])];
                activeInst.triggerAttack(note);
            }
        };

        keyboard.keyUp = function (note, frequency) {
            let instCh = instrumentList.getElementsByClassName('active');
            if (instCh !== null) {
                let activeInst = instruments[nodeIndex(instCh[0])];
                activeInst.triggerRelease();
            }
        };

    </script>
</body>

</html>